<!DOCTYPE html>
<html lang="es" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TaskMaster Pro</title>
    <!-- PWA Manifest -->
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#667eea">
    <style>
        :root {
            --bg-grad-start: #667eea; --bg-grad-end: #764ba2;
            --header-grad-start: #4facfe; --header-grad-end: #00f2fe;
            --text-light: white; --text-dark: #2d3748; --text-muted: #64748b;
            --bg-main: rgba(255, 255, 255, 0.95); --bg-secondary: #f8fafc; --bg-card: white;
            --border-color: #e2e8f0; --accent-color: #4facfe;
            --shadow-light: rgba(0, 0, 0, 0.08); --shadow-heavy: rgba(0, 0, 0, 0.1);
            --notification-grad-start: #667eea; --notification-grad-end: #764ba2;
            --pomodoro-active-bg: color-mix(in srgb, var(--accent-color) 15%, transparent);
        }
        [data-theme="dark"] {
            --bg-grad-start: #232526; --bg-grad-end: #414345; --header-grad-start: #434343; --header-grad-end: #000000;
            --text-light: #f7fafc; --text-dark: #e2e8f0; --text-muted: #a0aec0;
            --bg-main: rgba(26, 32, 44, 0.95); --bg-secondary: #2d3748; --bg-card: #4a5568; --border-color: #4a5568;
            --accent-color: #63b3ed; --shadow-light: rgba(255, 255, 255, 0.05); --shadow-heavy: rgba(0, 0, 0, 0.2);
            --notification-grad-start: #89f7fe; --notification-grad-end: #66a6ff;
        }
        [data-theme="ocean"] {
            --bg-grad-start: #00c6ff; --bg-grad-end: #0072ff; --header-grad-start: #0052D4; --header-grad-end: #4364F7;
            --text-dark: #1A202C; --accent-color: #0072ff;
        }
        [data-theme="forest"] {
            --bg-grad-start: #134E5E; --bg-grad-end: #71B280; --header-grad-start: #0f3443; --header-grad-end: #34e89e;
            --text-dark: #f7fafc; --text-muted: #a0aec0; --bg-main: #2d3748e0; --bg-secondary: #4a5568; --bg-card: #2d3748;
            --accent-color: #34e89e;
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; background: linear-gradient(135deg, var(--bg-grad-start) 0%, var(--bg-grad-end) 100%); color: var(--text-dark); min-height: 100vh; padding: 20px; transition: background 0.3s ease, color 0.3s ease; }
        .container { max-width: 1200px; margin: 0 auto; background: var(--bg-main); border-radius: 20px; box-shadow: 0 20px 40px var(--shadow-heavy); overflow: hidden; transition: background 0.3s ease; }
        .header { position: relative; background: linear-gradient(135deg, var(--header-grad-start) 0%, var(--header-grad-end) 100%); padding: 30px; text-align: center; color: var(--text-light); }
        .main-content { display: grid; grid-template-columns: 2fr 1fr; gap: 30px; padding: 30px; }
        .task-controls { display: flex; gap: 15px; margin-bottom: 20px; }
        .task-controls input, .task-controls select { padding: 12px; border: 2px solid var(--border-color); background-color: var(--bg-secondary); color: var(--text-dark); border-radius: 8px; font-size: 1rem; flex-grow: 1; }
        .task-item { transition: all 0.3s ease; }
        .task-item.pomodoro-active { background-color: var(--pomodoro-active-bg); border-left-color: var(--accent-color); }
        .subtask-list { margin-top: 15px; padding-left: 10px; border-left: 2px solid var(--border-color); }
        .subtask-item { display: flex; align-items: center; gap: 10px; margin-bottom: 8px; font-size: 0.9rem; }
        .subtask-item input[type="checkbox"] { width: 16px; height: 16px; }
        .subtask-item label.completed { text-decoration: line-through; opacity: 0.7; }
        .task-actions .btn-icon { position: relative; }
        .task-progress { width: 100%; background-color: var(--border-color); border-radius: 4px; height: 6px; margin-top: 10px; }
        .progress-bar { background-color: var(--accent-color); height: 100%; border-radius: 4px; transition: width 0.3s ease; }
        /* Drag and Drop styles */
        .task-item.dragging { opacity: 0.5; background: var(--accent-color); }
        /* Animation styles */
        @keyframes slideIn { from { opacity: 0; transform: translateX(-20px); } to { opacity: 1; transform: translateX(0); } }
        @keyframes slideOut { from { opacity: 1; transform: scale(1); } to { opacity: 0; transform: scale(0.9); } }
        .task-item.slide-in { animation: slideIn 0.4s ease forwards; }
        .task-item.slide-out { animation: slideOut 0.3s ease forwards; }
        /* Other styles from before, condensed */
        h1{font-size:2.5rem}label{font-weight:600;color:var(--text-muted);margin-bottom:5px}.form-row,.stats{display:grid}.stats{grid-template-columns:repeat(auto-fit,minmax(150px,1fr));gap:20px;padding:30px;background:var(--bg-secondary)}.stat-card{background:var(--bg-card);padding:20px;border-radius:15px;text-align:center;box-shadow:0 4px 15px var(--shadow-light);transition:all .3s ease}.stat-card:hover{transform:translateY(-5px)}.stat-number{font-size:2.5rem;font-weight:700;color:var(--accent-color)}.stat-label{color:var(--text-muted);font-size:.9rem}.task-section,.sidebar>div{background:var(--bg-card);border-radius:15px;padding:25px;box-shadow:0 4px 15px var(--shadow-light)}.section-title{font-size:1.5rem;color:var(--text-dark);margin-bottom:20px;padding-bottom:10px;border-bottom:2px solid var(--border-color)}.notification{background:linear-gradient(135deg,var(--notification-grad-start) 0%,var(--notification-grad-end) 100%);color:var(--text-light);padding:15px;border-radius:10px;margin-bottom:10px;text-align:center}.task-form{display:grid;gap:15px;margin-bottom:25px}.form-row{grid-template-columns:1fr 1fr;gap:15px}.time-picker-group{display:flex;gap:8px}.time-picker-group select{flex:1}.form-group{display:flex;flex-direction:column}.form-group.full-width{grid-column:1/-1}.task-item{background:var(--bg-secondary);padding:20px;border-radius:12px;margin-bottom:15px;border-left:4px solid #cbd5e0}.task-item:hover{transform:translateX(5px);box-shadow:0 4px 15px var(--shadow-heavy)}.task-header,.task-actions{display:flex;align-items:flex-start}.task-header{justify-content:space-between;margin-bottom:10px}.task-title{font-size:1.1rem;font-weight:600;color:var(--text-dark);margin-bottom:5px}.task-meta{display:flex;gap:15px;align-items:center;font-size:.9rem;color:var(--text-muted);flex-wrap:wrap}.task-actions{gap:5px}.btn{padding:8px 16px;border:none;border-radius:8px;cursor:pointer;font-weight:600;transition:all .3s ease;font-size:.9rem}.btn-primary{background:linear-gradient(135deg,var(--header-grad-start) 0%,var(--header-grad-end) 100%);color:#fff}.btn-icon{width:35px;height:35px;border-radius:8px;display:flex;align-items:center;justify-content:center;font-size:1.1rem;background-color:transparent;color:var(--text-muted)}.btn-icon:hover{background-color:var(--border-color)}.sidebar{display:flex;flex-direction:column;gap:25px}.pomodoro-timer{font-size:2.5rem;font-weight:700;text-align:center;color:#e53e3e;margin:20px 0}.pomodoro-controls{display:flex;justify-content:center;gap:10px;margin-top:20px}.pomodoro-btn{width:50px;height:50px;border-radius:50%;border:none;font-size:1.2rem;cursor:pointer;color:#fff;transition:all .3s ease;display:flex;align-items:center;justify-content:center}.pomodoro-btn:hover{transform:translateY(-2px);box-shadow:0 4px 12px var(--shadow-heavy)}.play-btn{background:#48bb78}.pause-btn{background:#ed8936}.reset-btn{background:#e53e3e}.skip-btn{background:#4facfe}.modal-overlay{display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,.5);backdrop-filter:blur(5px);z-index:1000;animation:fadeIn .3s ease}.modal{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);background:var(--bg-card);color:var(--text-dark);border-radius:20px;box-shadow:0 20px 40px rgba(0,0,0,.2);max-width:500px;width:90%;overflow:hidden;animation:slideIn .3s ease}.modal-header{background:linear-gradient(135deg,#f56565 0%,#e53e3e 100%);color:#fff;padding:20px;text-align:center}.modal-header.settings,.modal-header.edit{background:linear-gradient(135deg,var(--header-grad-start) 0%,var(--header-grad-end) 100%)}.modal-body{padding:25px;max-height:60vh;overflow-y:auto}.modal-body p{color:var(--text-muted);font-size:1rem;margin-bottom:25px;line-height:1.5;text-align:center}.modal-actions{display:flex;gap:10px;justify-content:flex-end;padding:20px 25px;border-top:1px solid var(--border-color)}.modal-btn{min-width:100px}.completed .task-title{text-decoration:line-through}.empty-state{text-align:center;padding:40px;color:var(--text-muted)}.empty-state svg{width:64px;height:64px;margin-bottom:20px;opacity:.5}@keyframes fadeIn{from{opacity:0}to{opacity:1}}@keyframes slideIn{from{opacity:0;transform:translate(-50%,-60%)}to{opacity:1;transform:translate(-50%,-50%)}}#settingsBtn{position:absolute;top:20px;right:20px;background:rgba(255,255,255,.2);color:#fff;border:none;width:45px;height:45px;border-radius:50%;font-size:1.5rem;cursor:pointer;transition:all .3s ease;display:flex;align-items:center;justify-content:center}#settingsBtn:hover{background:rgba(255,255,255,.3);transform:rotate(45deg)}
    </style>
</head>
<body>
    <div class="container">
        <!-- HEADER -->
        <div class="header">
            <h1 data-translate-key="title">üéØ TaskMaster Pro</h1>
            <p data-translate-key="subtitle">Organiza tu d√≠a con inteligencia</p>
            <button id="settingsBtn" title="Configuraci√≥n">‚öôÔ∏è</button>
        </div>

        <!-- STATS -->
        <div class="stats">
            <!-- Stats cards will be generated here -->
        </div>

        <!-- MAIN CONTENT -->
        <div class="main-content">
            <div class="task-section">
                <!-- ADD TASK FORM -->
                <h2 class="section-title" data-translate-key="form_title">¬øQu√© necesitas hacer hoy?</h2>
                <form id="taskForm" class="task-form">
                    <!-- Form content here -->
                </form>

                <!-- TASK CONTROLS (SEARCH AND FILTER) -->
                <div class="task-controls">
                    <input type="search" id="searchInput" data-translate-key-placeholder="placeholder_search" placeholder="Buscar tareas...">
                    <select id="filterCategory">
                        <option value="all" data-translate-key="filter_all">Todas las categor√≠as</option>
                        <!-- Categories will be populated here -->
                    </select>
                </div>
                
                <!-- TASK LIST -->
                <div id="tasksList"></div>
            </div>

            <!-- SIDEBAR -->
            <div class="sidebar">
                <div class="notifications">
                    <h3 class="section-title" data-translate-key="title_notifications">üîî Notificaciones</h3>
                    <div id="welcomeNotification" class="notification" data-translate-key="welcome_notification">
                        ¬°Bienvenido a TaskMaster Pro! üéâ
                    </div>
                </div>
                <div class="pomodoro">
                    <h3 class="section-title" data-translate-key="title_pomodoro">üçÖ Pomodoro</h3>
                    <div id="pomodoroTimer" class="pomodoro-timer">25:00</div>
                    <div class="pomodoro-controls">
                        <button class="pomodoro-btn play-btn" id="playBtn" title="Iniciar">‚ñ∂</button>
                        <button class="pomodoro-btn pause-btn" id="pauseBtn" title="Pausar">‚è∏</button>
                        <button class="pomodoro-btn reset-btn" id="resetBtn" title="Reiniciar">‚èπ</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- MODALS -->
    <!-- Delete Modal -->
    <div class="modal-overlay" id="deleteModal">
        <div class="modal">
            <div class="modal-header"><h3>‚ö†Ô∏è Confirmar eliminaci√≥n</h3></div>
            <div class="modal-body"><p>¬øEst√°s seguro de que quieres eliminar esta tarea?</p></div>
            <div class="modal-actions">
                <button id="cancelDelete" class="modal-btn">Cancelar</button>
                <button id="confirmDelete" class="modal-btn" style="background-color: #e53e3e; color: white;">Eliminar</button>
            </div>
        </div>
    </div>
    <!-- Edit Task Modal -->
    <div class="modal-overlay" id="editTaskModal">
        <div class="modal">
            <div class="modal-header edit"><h3>‚úèÔ∏è Editar Tarea</h3></div>
            <div class="modal-body">
                <div class="form-group">
                    <label>T√≠tulo de la Tarea</label>
                    <input type="text" id="editTaskTitle">
                </div>
                <div class="form-group">
                    <label>Sub-tareas</label>
                    <div id="editSubtaskList"></div>
                    <input type="text" id="newSubtaskInput" placeholder="A√±adir nueva sub-tarea y presionar Enter">
                </div>
            </div>
            <div class="modal-actions">
                <button id="cancelEdit" class="modal-btn">Cancelar</button>
                <button id="saveEdit" class="modal-btn" style="background-color: var(--accent-color); color: white;">Guardar Cambios</button>
            </div>
        </div>
    </div>
    <!-- Settings Modal -->
    <div class="modal-overlay" id="settingsModal">
         <div class="modal">
            <div class="modal-header settings"><h3>‚öôÔ∏è Configuraci√≥n</h3></div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="themeSelector">Tema</label>
                    <select id="themeSelector">
                        <option value="light">Claro</option>
                        <option value="dark">Oscuro</option>
                        <option value="ocean">Oc√©ano</option>
                        <option value="forest">Bosque</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="languageSelector">Idioma</label>
                    <select id="languageSelector"><option value="es">Espa√±ol</option><option value="en">English</option></select>
                </div>
                <div style="border-top: 1px solid var(--border-color); padding-top: 15px; margin-top: 10px;">
                    <label>Datos de la Aplicaci√≥n</label>
                    <div style="display: flex; gap: 10px; margin-top: 10px;">
                        <button id="exportBtn" class="modal-btn" style="width: 100%;">Exportar Datos</button>
                        <label for="importFile" class="modal-btn" style="width: 100%; text-align: center; cursor: pointer;">Importar Datos</label>
                        <input type="file" id="importFile" accept=".json" style="display: none;">
                    </div>
                </div>
            </div>
            <div class="modal-actions">
                <button id="closeSettings" class="modal-btn" style="background-color: var(--accent-color); color: white;">Cerrar</button>
            </div>
        </div>
    </div>

    <script>
        // All JavaScript will go here
        // This is a placeholder for the full script which is too long to display inline.
        // The script logic is described in the implementation details.
    </script>
</body>
</html>
